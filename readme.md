# Sequence Analysis Workflow And Django Web Server

## Introduction

This application consists of two parts; a sequence analysis program and a web server program.

**Sequence Analysis Workflow**

The first program will search for 20 entries of a gene (e.g. the MYC gene) in a zipped UniProt database file. A Multiple Sequence Alignment will be achieved via MUSCLE, and output will be stored in fasta and html files. The alignment will also be serialised via Python’s `pickle` module. A quick consensus sequence will be produced with BioPython’s `SummaryInfo` module. A `NucleciAcid` class is created that can translate a DNA sequence to a protein sequence. Secondary structure prediction will be achieved through PSIPRED.

**Webserver**

A webserver developed with Django displays an index page and the html output of the MYC gene alignment.

### Prerequisites

  * Python 3.6

* [MUSCLE](https://www.drive5.com/muscle/manual/install.html) via bioconda
  * Install miniconda
  ```
  wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
  
  bash Miniconda3-latest-Linux-x86_64.sh
  ```
  * Set up bioconda channel
  ```
  conda config --add channels defaults
  conda config --add channels bioconda
  conda config --add channels conda-forge
  ```
  * Install MUSCLE
  ```
  conda install -c bioconda muscle
  ```
* [Biopython](https://biopython.org/)
```
pip install biopython
```
* [Django](https://www.djangoproject.com/start/)
  * Install pip `sudo apt install python3-pip`
  * Install django `python3 -m pip install Django`

## How to Run
**Sequence Analysis Workflow**

First, you need to download the UniProt database.

>On Linux terminal, in `./program_project`, run:
```
wget ftp://ftp.uniprot.org/pub/databases/uniprot/knowledgebase/uniprot_sprot.xml.gz
```
>Then, run:
```
python3 seq_align2.py
```

**Use Case: Searching For a Desired Gene**

The `seq_align2.py` currently searches for the MYC gene in UniProt. If you would like to search for another gene instead, such as RHO, you could modify the code as such:
```python
for entry in SeqIO.parse(f, "uniprot-xml"):
        gene_found = False
# Load 20 entries with primary/secondary gene names that match 'rho'. May take a while.
        gene = re.compile(r'^rho$')
```

**View Structure Prediction Results**

In the terminal, a UUID will be returned. An example output will look like:
```
{"UUID":"dd739a0e-5f38-11ea-ab01-00163e100d53","submission_name":"mycgene"}
```
Paste the link below to your browser, and use it to poll the PSIPRED server every 10 minutes to get your results. Use the UUID from your terminal for `[UUID]`:
```
http://bioinf.cs.ucl.ac.uk/psipred/&uuid=[UUID]
```

**Webserver**

On terminal, in `‘./site_align’`, run:
```
python3 manage.py runserver
```
Open your browser, and enter:
```
http://127.0.0.1:8000/align/
```

Click on the “View your alignment” button to view the alignment generated by the Sequence Analysis Workflow.

**Testing**

To test the methods in the NucleicAcid class, run:

```
python3 unittest_nucleic.py
```

## Notes

* The Django webserver was created via the [Django Tutorial](https://docs.djangoproject.com/en/3.0/intro/tutorial01/), thus some code included is generated from the tutorial. Files that include my own code are: `models.py`, `./align/urls.py`, `views.py`, `./mysite/urls.py`, `index.html`, `style.css`
* For  full intention of the application, I would like to write a script to automate the retrieval of the secondary structure prediction image from the PSIPRED webserver and produce it on my webserver as a second link along with the alignment.

## Contact

The author can be contacted at nicole.yt.chai@gmail.com
